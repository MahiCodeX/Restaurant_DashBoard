<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Coupons - Gourmet Delight</title>
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    * { 
      margin:0; 
      padding:0; 
      box-sizing:border-box; 
      font-family:'Source Sans Pro', sans-serif; 
    }
    
    :root {
      --primary: #1a365d;
      --primary-dark: #0f1e35;
      --secondary: #2c5282;
      --accent: #3182ce;
      --accent-light: #63b3ed;
      --light: #f7fafc;
      --light-alt: #edf2f7;
      --gray: #718096;
      --gray-light: #a0aec0;
      --gray-lighter: #e2e8f0;
      --success: #38a169;
      --warning: #d69e2e;
      --danger: #e53e3e;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
      --shadow-md: 0 10px 15px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 20px 25px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 25px 50px rgba(0, 0, 0, 0.15);
    }
    
    body {
      background: linear-gradient(135deg, #f7fafc 0%, #e2e8f0 100%);
      min-height:100vh; 
      padding:20px;
      position: relative;
      overflow-x: hidden;
      color: var(--primary);
    }
    
    /* Animated Background Elements */
    .bg-animation {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    
    .bg-pattern {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(26, 54, 93, 0.03) 0%, transparent 20%),
        radial-gradient(circle at 80% 30%, rgba(49, 130, 206, 0.03) 0%, transparent 20%),
        radial-gradient(circle at 40% 70%, rgba(26, 54, 93, 0.03) 0%, transparent 20%),
        radial-gradient(circle at 90% 90%, rgba(49, 130, 206, 0.03) 0%, transparent 20%);
      animation: patternShift 30s ease infinite;
    }
    
    @keyframes patternShift {
      0%, 100% { 
        transform: translateX(0) translateY(0); 
      }
      25% { 
        transform: translateX(-20px) translateY(10px); 
      }
      50% { 
        transform: translateX(10px) translateY(-20px); 
      }
      75% { 
        transform: translateX(-10px) translateY(-10px); 
      }
    }
    
    .bg-line {
      position: absolute;
      background: linear-gradient(90deg, transparent, rgba(26, 54, 93, 0.05), transparent);
      height: 1px;
      width: 100%;
      animation: lineMove 20s linear infinite;
    }
    
    @keyframes lineMove {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    /* Header */
    header {
      display:flex; 
      justify-content:space-between; 
      align-items:center;
      background:var(--primary); 
      color:var(--light); 
      padding:15px 20px; 
      border-radius:8px;
      box-shadow:var(--shadow-lg);
      margin-bottom:25px;
      position: sticky;
      top: 20px;
      z-index: 100;
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(49, 130, 206, 0.1) 0%, transparent 100%);
      pointer-events: none;
    }
    
    header h1 { 
      font-size:28px; 
      font-family: 'Playfair Display', serif;
      position: relative;
      z-index: 1;
    }
    
    header nav {
      display:flex;
      align-items:center;
      gap:20px;
    }
    
    header nav a {
      color:var(--light); 
      text-decoration:none; 
      font-weight:500;
      font-size:16px;
      transition:0.3s;
      position: relative;
      padding:5px 10px;
      border-radius:8px;
    }
    
    header nav a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 2px;
      background: var(--accent-light);
      transition: width 0.3s ease;
      transform: translateX(-50%);
    }
    
    header nav a:hover::after {
      width: 100%;
    }
    
    header nav a:hover { 
      background:rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }
    
    header nav a.active {
      background: rgba(255, 255, 255, 0.2);
    }
    
    header nav a.active::after {
      width: 100%;
    }
    
    /* Main Container */
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h2 { 
      color:var(--primary); 
      margin-bottom:25px; 
      text-align:center;
      font-size: 32px;
      font-family: 'Playfair Display', serif;
      position: relative;
    }
    
    h2::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: var(--accent);
    }
    
    /* Header Section */
    .header-section {
      text-align: center;
      margin-bottom: 40px;
      animation: fadeInDown 0.8s ease;
    }
    
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .header-section h1 {
      color: var(--primary);
      margin-bottom: 15px;
      font-size: 36px;
      font-family: 'Playfair Display', serif;
      position: relative;
      display: inline-block;
    }
    
    .header-section h1::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--accent);
      transform: scaleX(0);
      animation: lineExpand 1s ease forwards;
      animation-delay: 0.5s;
    }
    
    @keyframes lineExpand {
      to { transform: scaleX(1); }
    }
    
    .subtitle {
      color: var(--gray);
      font-size: 18px;
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Stats Section */
    .stats-container {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    
    .stat-card {
      background: var(--light);
      border-radius: 8px;
      padding: 20px 30px;
      text-align: center;
      box-shadow: var(--shadow-md);
      transition: 0.3s;
      border: 1px solid var(--gray-lighter);
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .stat-number {
      font-size: 24px;
      font-weight: 700;
      color: var(--accent);
    }
    
    .stat-label {
      font-size: 14px;
      color: var(--gray);
    }
    
    /* Search and Filter Section */
    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 20px;
      background: var(--light);
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--gray-lighter);
    }
    
    .search-box {
      position: relative;
      flex: 1;
      min-width: 250px;
      max-width: 400px;
    }
    
    .search-box input {
      width: 100%;
      padding: 12px 40px 12px 15px;
      border: 1px solid var(--gray-lighter);
      border-radius: 25px;
      background: var(--light-alt);
      box-shadow: none;
      font-size: 16px;
      transition: 0.3s;
    }
    
    .search-box input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 8px rgba(49, 130, 206, 0.2);
    }
    
    .search-box i {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
    }
    
    .filter-buttons {
      display: flex;
      gap: 10px;
    }
    
    .filter-btn {
      padding: 10px 20px;
      border: 1px solid var(--gray-lighter);
      border-radius: 20px;
      background: var(--light);
      color: var(--gray);
      font-weight: 500;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .filter-btn:hover, .filter-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    /* Coupon Grid */
    .coupon-grid {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap:25px;
      max-width:1200px;
      margin:0 auto;
    }
    
    .coupon-card {
      background:var(--light);
      border-radius:8px;
      padding:25px;
      box-shadow:var(--shadow-md);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
      animation: fadeInUp 0.8s ease forwards;
      opacity: 0;
      border: 1px solid var(--gray-lighter);
    }
    
    .coupon-card:nth-child(1) { animation-delay: 0.1s; }
    .coupon-card:nth-child(2) { animation-delay: 0.2s; }
    .coupon-card:nth-child(3) { animation-delay: 0.3s; }
    .coupon-card:nth-child(4) { animation-delay: 0.4s; }
    .coupon-card:nth-child(5) { animation-delay: 0.5s; }
    .coupon-card:nth-child(6) { animation-delay: 0.6s; }
    .coupon-card:nth-child(7) { animation-delay: 0.7s; }
    .coupon-card:nth-child(8) { animation-delay: 0.8s; }
    
    @keyframes fadeInUp {
      from { 
        opacity: 0; 
        transform: translateY(30px); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }
    
    .coupon-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: var(--accent);
    }
    
    .coupon-card:hover {
      transform: translateY(-10px);
      box-shadow:var(--shadow-xl);
    }
    
    .coupon-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }
    
    .coupon-card h3 {
      color:var(--primary);
      font-size:22px;
      margin-bottom: 5px;
    }
    
    .coupon-category {
      display: inline-block;
      padding: 5px 10px;
      background: rgba(49, 130, 206, 0.1);
      color: var(--accent);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .coupon-card p {
      color:var(--gray);
      font-size:16px;
      margin-bottom:15px;
      line-height: 1.5;
    }
    
    .coupon-code-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }
    
    .coupon-code {
      display:inline-block;
      background:var(--light-alt);
      color:var(--primary);
      padding:10px 15px;
      font-weight:700;
      border-radius:8px;
      font-size:16px;
      letter-spacing:1px;
      transition:0.3s all;
      cursor:pointer;
      position: relative;
      overflow: hidden;
    }
    
    .coupon-code::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(49, 130, 206, 0.2);
      transition: 0.5s;
    }
    
    .coupon-card:hover .coupon-code::before {
      left: 100%;
    }
    
    .coupon-card:hover .coupon-code {
      background:var(--accent);
      color:var(--light);
      transform: scale(1.05);
    }
    
    .copy-icon {
      color: var(--gray);
      cursor: pointer;
      transition: 0.3s;
    }
    
    .copy-icon:hover {
      color: var(--accent);
    }
    
    .coupon-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .expiry {
      font-size:14px;
      color:var(--gray);
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .expiry.expiring-soon {
      color: var(--danger);
      font-weight: 500;
    }
    
    .btn-redeem {
      display:block;
      padding:10px 20px;
      background:var(--accent);
      color:var(--light);
      border:none;
      border-radius:8px;
      font-weight:600;
      cursor:pointer;
      transition:0.3s all;
      position: relative;
      overflow: hidden;
    }
    
    .btn-redeem::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn-redeem:hover::before {
      width: 300px;
      height: 300px;
    }
    
    .btn-redeem:hover {
      background:var(--secondary);
      transform:scale(1.05);
      box-shadow: 0 5px 15px rgba(49, 130, 206, 0.3);
    }
    
    .btn-redeem.used {
      background: var(--gray-light);
      cursor: not-allowed;
    }
    
    .btn-redeem.used:hover {
      background: var(--gray-light);
      transform: none;
      box-shadow: none;
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: var(--light);
      border-radius: 8px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      position: relative;
      animation: modalFadeIn 0.3s ease;
      box-shadow: var(--shadow-xl);
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 24px;
      color: var(--gray);
      cursor: pointer;
      transition: 0.3s;
    }
    
    .close-modal:hover {
      color: var(--danger);
    }
    
    .modal h2 {
      color: var(--primary);
      margin-bottom: 20px;
      font-family: 'Playfair Display', serif;
    }
    
    .modal p {
      margin-bottom: 15px;
      line-height: 1.5;
      color: var(--gray);
    }
    
    .modal-code {
      background: var(--light-alt);
      padding: 15px;
      border-radius: 8px;
      font-weight: 700;
      font-size: 18px;
      text-align: center;
      margin: 20px 0;
      letter-spacing: 1px;
      color: var(--primary);
    }
    
    .modal-buttons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .modal-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }
    
    .modal-btn-primary {
      background: var(--accent);
      color: white;
    }
    
    .modal-btn-primary:hover {
      background: var(--secondary);
    }
    
    .modal-btn-secondary {
      background: var(--light-alt);
      color: var(--gray);
    }
    
    .modal-btn-secondary:hover {
      background: var(--gray-lighter);
    }
    
    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--light);
      padding: 15px 25px;
      border-radius: 50px;
      box-shadow: var(--shadow-xl);
      z-index: 2000;
      opacity: 0;
      transition: transform 0.3s, opacity 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
      border: 1px solid var(--gray-lighter);
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    
    .toast.success {
      border-left: 4px solid var(--success);
    }
    
    .toast.error {
      border-left: 4px solid var(--danger);
    }
    
    .toast i {
      font-size: 20px;
    }
    
    .toast.success i {
      color: var(--success);
    }
    
    .toast.error i {
      color: var(--danger);
    }
    
    /* No Results Message */
    .no-results {
      text-align: center;
      padding: 50px 20px;
      color: var(--gray);
      display: none;
    }
    
    .no-results i {
      font-size: 48px;
      color: var(--accent);
      margin-bottom: 15px;
    }
    
    /* Responsive Design */
    @media(max-width:768px) {
      header {
        flex-direction: column;
        gap: 15px;
      }
      
      header h1 {
        font-size: 24px;
      }
      
      .controls {
        flex-direction: column;
      }
      
      .search-box {
        max-width: 100%;
      }
      
      .filter-buttons {
        width: 100%;
        justify-content: center;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .coupon-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Animated Background -->
  <div class="bg-animation" id="bgAnimation">
    <div class="bg-pattern"></div>
    <div class="bg-line" style="top: 20%;"></div>
    <div class="bg-line" style="top: 40%; animation-delay: 5s;"></div>
    <div class="bg-line" style="top: 60%; animation-delay: 10s;"></div>
    <div class="bg-line" style="top: 80%; animation-delay: 15s;"></div>
  </div>
  
  <!-- Header -->
  <header>
    <h1>Food Mahal</h1>
    <nav>
      <a href="user_dashboard.html">Home</a>
      <a href="user_menu.html">Menu</a>
      <a href="user_reservation.html">Reservations</a>
      <a href="user_order.html">My Orders</a>
      <a href="user_coupons.html" class="active">Coupons</a>
    </nav>
  </header>
  
  <!-- Header Section -->
  <div class="header-section">
    <h1>Your Coupons</h1>
    <p class="subtitle">Save money on your favorite dishes with these exclusive offers</p>
  </div>
  
  <!-- Stats Section -->
  <div class="stats-container">
    <div class="stat-card">
      <div class="stat-number" id="totalCoupons">8</div>
      <div class="stat-label">Total Coupons</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="activeCoupons">8</div>
      <div class="stat-label">Active</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="savedAmount">$0</div>
      <div class="stat-label">Total Saved</div>
    </div>
  </div>
  
  <!-- Search and Filter Section -->
  <div class="controls">
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="Search coupons...">
      <i class="fas fa-search"></i>
    </div>
    <div class="filter-buttons">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="food">Food</button>
      <button class="filter-btn" data-filter="drink">Drink</button>
      <button class="filter-btn" data-filter="dessert">Dessert</button>
      <button class="filter-btn" data-filter="combo">Combo</button>
    </div>
  </div>
  
  <!-- Coupon Grid -->
  <div class="coupon-grid" id="couponGrid">
    <!-- Coupons will be dynamically generated -->
  </div>
  
  <!-- No Results Message -->
  <div class="no-results" id="noResults">
    <i class="fas fa-search"></i>
    <h3>No coupons found</h3>
    <p>Try adjusting your search or filter criteria</p>
  </div>
  
  <!-- Coupon Details Modal -->
  <div class="modal" id="couponModal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle">Coupon Details</h2>
      <p id="modalDescription">Description</p>
      <div class="modal-code" id="modalCode">CODE</div>
      <p><strong>Valid until:</strong> <span id="modalExpiry">Date</span></p>
      <p><strong>Terms & Conditions:</strong></p>
      <ul>
        <li>Coupon cannot be combined with other offers</li>
        <li>Valid only at Food Mahal outlets</li>
        <li>One coupon per customer per visit</li>
        <li>Coupon must be presented before ordering</li>
      </ul>
      <div class="modal-buttons">
        <button class="modal-btn modal-btn-primary" onclick="redeemCoupon(document.getElementById('modalCode').textContent)">Redeem Now</button>
        <button class="modal-btn modal-btn-secondary" onclick="copyCode(document.getElementById('modalCode').textContent)">Copy Code</button>
      </div>
    </div>
  </div>
  
  <!-- Toast Notification -->
  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMessage">Message</span>
  </div>

  <script>
    // Initialize background animation
    function initBackgroundAnimation() {
      const bgAnimation = document.getElementById('bgAnimation');
      const colors = ['#1a365d', '#2c5282', '#3182ce', '#63b3ed', '#4299e1'];
      
      for (let i = 0; i < 8; i++) {
        const circle = document.createElement('div');
        circle.classList.add('bg-circle');
        
        const size = Math.random() * 200 + 50;
        circle.style.width = `${size}px`;
        circle.style.height = `${size}px`;
        
        circle.style.left = `${Math.random() * 100}%`;
        circle.style.top = `${Math.random() * 100}%`;
        
        circle.style.background = colors[Math.floor(Math.random() * colors.length)];
        circle.style.opacity = '0.03';
        
        circle.style.animationDelay = `${Math.random() * 5}s`;
        circle.style.animationDuration = `${Math.random() * 10 + 15}s`;
        
        bgAnimation.appendChild(circle);
      }
    }
    
    // Coupon data - same as in menu and orders pages
    const coupons = [
      { 
        code: 'SAVE10', 
        discount: 10, 
        type: 'percentage', 
        minOrder: 20,
        title: '10% Off Your Order',
        description: 'Get 10% discount on your order of $20 or more.',
        category: 'food',
        expiry: '31 Oct 2025'
      },
      { 
        code: 'SAVE20', 
        discount: 20, 
        type: 'percentage', 
        minOrder: 50,
        title: '20% Off Your Order',
        description: 'Get 20% discount on your order of $50 or more.',
        category: 'food',
        expiry: '30 Nov 2025'
      },
      { 
        code: 'FLAT5', 
        discount: 5, 
        type: 'fixed', 
        minOrder: 15,
        title: '$5 Off Your Order',
        description: 'Get $5 discount on your order of $15 or more.',
        category: 'combo',
        expiry: '15 Nov 2025'
      },
      { 
        code: 'FIRSTORDER', 
        discount: 15, 
        type: 'percentage', 
        minOrder: 25,
        title: '15% Off First Order',
        description: 'Get 15% discount on your first order of $25 or more.',
        category: 'food',
        expiry: '31 Dec 2025'
      },
      { 
        code: 'WEEKEND', 
        discount: 10, 
        type: 'percentage', 
        minOrder: 30,
        title: 'Weekend Special',
        description: 'Get 10% discount on your weekend order of $30 or more.',
        category: 'combo',
        expiry: '25 Nov 2025'
      },
      { 
        code: 'PIZZA10', 
        discount: 10, 
        type: 'percentage', 
        minOrder: 20,
        title: '10% Off Pizza',
        description: 'Get 10% discount on all pizzas this weekend.',
        category: 'food',
        expiry: '31 Oct 2025'
      },
      { 
        code: 'FREEDRINK', 
        discount: 5, 
        type: 'fixed', 
        minOrder: 15,
        title: 'Free Drink',
        description: 'Order any main course and get a free drink.',
        category: 'drink',
        expiry: '30 Nov 2025'
      },
      { 
        code: 'SWEET15', 
        discount: 15, 
        type: 'percentage', 
        minOrder: 10,
        title: '15% Off Desserts',
        description: 'Enjoy 15% discount on all desserts every Friday.',
        category: 'dessert',
        expiry: '31 Dec 2025'
      }
    ];
    
    // Get used coupons from localStorage
    function getUsedCoupons() {
      const usedCoupons = localStorage.getItem('usedCoupons');
      return usedCoupons ? JSON.parse(usedCoupons) : [];
    }
    
    // Mark coupon as used
    function markCouponAsUsed(code) {
      const usedCoupons = getUsedCoupons();
      if (!usedCoupons.includes(code)) {
        usedCoupons.push(code);
        localStorage.setItem('usedCoupons', JSON.stringify(usedCoupons));
      }
    }
    
    // Check if coupon is used
    function isCouponUsed(code) {
      const usedCoupons = getUsedCoupons();
      return usedCoupons.includes(code);
    }
    
    // Get saved amount from localStorage
    function getSavedAmount() {
      const savedAmount = localStorage.getItem('totalSaved');
      return savedAmount ? parseFloat(savedAmount) : 0;
    }
    
    // Update saved amount
    function updateSavedAmount(amount) {
      const currentAmount = getSavedAmount();
      const newAmount = currentAmount + amount;
      localStorage.setItem('totalSaved', newAmount.toString());
      document.getElementById('savedAmount').textContent = `$${newAmount.toFixed(2)}`;
    }
    
    // Generate coupon cards
    function generateCouponCards() {
      const couponGrid = document.getElementById('couponGrid');
      const usedCoupons = getUsedCoupons();
      
      couponGrid.innerHTML = '';
      
      coupons.forEach((coupon, index) => {
        const isUsed = usedCoupons.includes(coupon.code);
        const today = new Date();
        const expiryDate = new Date(coupon.expiry);
        const daysDiff = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));
        const isExpiringSoon = daysDiff <= 7;
        
        const card = document.createElement('div');
        card.className = 'coupon-card';
        card.setAttribute('data-category', coupon.category);
        card.style.animationDelay = `${(index + 1) * 0.1}s`;
        
        card.innerHTML = `
          <div class="coupon-header">
            <h3>${coupon.title}</h3>
            <span class="coupon-category">${coupon.category.charAt(0).toUpperCase() + coupon.category.slice(1)}</span>
          </div>
          <p>${coupon.description}</p>
          <div class="coupon-code-container">
            <div class="coupon-code" onclick="copyCode('${coupon.code}')">${coupon.code}</div>
            <i class="fas fa-copy copy-icon" onclick="copyCode('${coupon.code}')"></i>
          </div>
          <div class="coupon-footer">
            <div class="expiry ${isExpiringSoon ? 'expiring-soon' : ''}">
              <i class="far fa-calendar"></i>
              <span>Expires: ${coupon.expiry}</span>
            </div>
            <button class="btn-redeem ${isUsed ? 'used' : ''}" onclick="showCouponDetails('${coupon.code}', '${coupon.title}', '${coupon.description}', '${coupon.expiry}', ${isUsed})">
              ${isUsed ? 'Used' : 'Details'}
            </button>
          </div>
        `;
        
        couponGrid.appendChild(card);
      });
      
      // Update stats
      document.getElementById('totalCoupons').textContent = coupons.length;
      document.getElementById('activeCoupons').textContent = coupons.length - usedCoupons.length;
      document.getElementById('savedAmount').textContent = `$${getSavedAmount().toFixed(2)}`;
    }
    
    // Filter functionality
    const filterButtons = document.querySelectorAll('.filter-btn');
    const noResults = document.getElementById('noResults');
    
    filterButtons.forEach(button => {
      button.addEventListener('click', () => {
        // Update active button
        filterButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        
        // Filter coupons
        const filter = button.getAttribute('data-filter');
        let visibleCount = 0;
        
        const couponCards = document.querySelectorAll('.coupon-card');
        couponCards.forEach(card => {
          if (filter === 'all' || card.getAttribute('data-category') === filter) {
            card.style.display = 'block';
            visibleCount++;
          } else {
            card.style.display = 'none';
          }
        });
        
        // Show/hide no results message
        if (visibleCount === 0) {
          noResults.style.display = 'block';
        } else {
          noResults.style.display = 'none';
        }
      });
    });
    
    // Search functionality
    const searchInput = document.getElementById('searchInput');
    
    searchInput.addEventListener('input', () => {
      const searchTerm = searchInput.value.toLowerCase();
      let visibleCount = 0;
      
      const couponCards = document.querySelectorAll('.coupon-card');
      couponCards.forEach(card => {
        const title = card.querySelector('h3').textContent.toLowerCase();
        const description = card.querySelector('p').textContent.toLowerCase();
        const code = card.querySelector('.coupon-code').textContent.toLowerCase();
        
        if (title.includes(searchTerm) || description.includes(searchTerm) || code.includes(searchTerm)) {
          card.style.display = 'block';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });
      
      // Show/hide no results message
      if (visibleCount === 0) {
        noResults.style.display = 'block';
      } else {
        noResults.style.display = 'none';
      }
    });
    
    // Copy coupon code
    function copyCode(code) {
      navigator.clipboard.writeText(code);
      showToast(`Coupon code '${code}' copied!`, 'success');
    }
    
    // Show coupon details modal
    function showCouponDetails(code, title, description, expiry, isUsed) {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalDescription').textContent = description;
      document.getElementById('modalCode').textContent = code;
      document.getElementById('modalExpiry').textContent = expiry;
      
      const redeemBtn = document.querySelector('.modal-btn-primary');
      if (isUsed) {
        redeemBtn.textContent = 'Already Used';
        redeemBtn.disabled = true;
        redeemBtn.style.background = 'var(--gray-light)';
      } else {
        redeemBtn.textContent = 'Redeem Now';
        redeemBtn.disabled = false;
        redeemBtn.style.background = 'var(--accent)';
      }
      
      document.getElementById('couponModal').style.display = 'flex';
    }
    
    // Close modal
    function closeModal() {
      document.getElementById('couponModal').style.display = 'none';
    }
    
    // Close modal when clicking outside
    window.onclick = function(event) {
      const modal = document.getElementById('couponModal');
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    }
    
    // Redeem coupon
    function redeemCoupon(code) {
      closeModal();
      
      // Find the coupon
      const coupon = coupons.find(c => c.code === code);
      if (!coupon) return;
      
      // Mark as used
      markCouponAsUsed(code);
      
      // Calculate potential savings (random for demo)
      const minOrder = coupon.minOrder;
      let savings = 0;
      
      if (coupon.type === 'percentage') {
        savings = minOrder * (coupon.discount / 100);
      } else {
        savings = coupon.discount;
      }
      
      // Update saved amount
      updateSavedAmount(savings);
      
      // Show success message
      showToast(`Coupon '${code}' redeemed successfully! You saved $${savings.toFixed(2)}`, 'success');
      
      // Regenerate cards to update button state
      generateCouponCards();
    }
    
    // Show toast notification
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      const icon = toast.querySelector('i');
      
      // Set message
      toastMessage.textContent = message;
      
      // Set type
      toast.className = 'toast ' + type;
      
      // Set icon
      if (type === 'success') {
        icon.className = 'fas fa-check-circle';
      } else if (type === 'error') {
        icon.className = 'fas fa-exclamation-circle';
      }
      
      // Show toast
      toast.classList.add('show');
      
      // Hide after 3 seconds
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
    
    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
      initBackgroundAnimation();
      generateCouponCards();
    });
  </script>
</body>
</html>